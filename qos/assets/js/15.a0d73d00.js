(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{171:function(s,n,a){"use strict";a.r(n);var t=a(0),e=Object(t.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("div",{staticClass:"content"},[a("h1",{attrs:{id:"genesis"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#genesis","aria-hidden":"true"}},[s._v("#")]),s._v(" Genesis")]),s._v(" "),a("p",[s._v("执行qosd init之后，默认会在$HOME/.qosd/config/目录下生成genesis.json配置文件")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('cat genesis.json\n{\n    ...\n    "app_state":{\n        // 添加自定义内容\n    }\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("app_state部分可自定义，在qos app 创建时编写相应代码逻辑可将该部分信息保存到创世块中")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("// 设置 InitChainer\n...\napp.SetInitChainer(app.initChainer)\n...\n// 初始配置\nfunc (app *QOSApp) initChainer(ctx context.Context, req abci.RequestInitChain) abci.ResponseInitChain {\n\t// 上下文中获取mapper\n\tmainMapper := ctx.Mapper(mapper.GetMainStoreKey()).(*mapper.MainMapper)\n\taccountMapper := ctx.Mapper(account.AccountMapperName).(*account.AccountMapper)\n\n\t// 反序列化app_state\n\tstateJSON := req.AppStateBytes\n\tgenesisState := &GenesisState{}\n\terr := accountMapper.GetCodec().UnmarshalJSON(stateJSON, genesisState)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\n\t// 保存CA\n\tmainMapper.SetRootCA(genesisState.CAPubKey)\n\n\t// 保存初始账户\n\tfor _, acc := range genesisState.Accounts {\n\t\taccountMapper.SetAccount(acc)\n\t}\n\n\treturn abci.ResponseInitChain{}\n}\n...\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br")])]),a("h2",{attrs:{id:"ca-pub-key"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ca-pub-key","aria-hidden":"true"}},[s._v("#")]),s._v(" ca_pub_key")]),s._v(" "),a("p",[s._v("CA PubKey")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('"ca_pub_key": {\n      "type": "tendermint/PubKeyEd25519",\n      "value": "0SDDvhiMsqX9XLuscqovU8l24txbV7Mg4ecs+R6Swzk="\n    }\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"accounts"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#accounts","aria-hidden":"true"}},[s._v("#")]),s._v(" accounts")]),s._v(" "),a("p",[s._v("初始账户")]),s._v(" "),a("blockquote",[a("p",[s._v("初始账户可以通过"),a("code",[s._v("qosd init add-genesis-account")]),s._v("命令添加")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('"accounts": [\n    {\n        "base_account": {\n            "account_address": "address1k0m8ucnqug974maa6g36zw7g2wvfd4sug6uxay"\n        },\n        "qos": "100000000",\n        "qscs": [\n            {\n                "coin_name": "qstar",\n                "amount": "100000000"\n            }\n        ]\n    }\n]\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h2",{attrs:{id:"qcps"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#qcps","aria-hidden":"true"}},[s._v("#")]),s._v(" qcps")]),s._v(" "),a("p",[s._v("联盟链配置")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('"qcps": [\n    {\n        "name": "qstars-test",\n        "chain_id": "qstars-test",\n        "pub_key": {\n            "type": "tendermint/PubKeyEd25519",\n            "value": "O0XnpXPYkn4jWXwBPgG1wp1aCx0tuug9Ylc0WHBnl5Q="\n        }\n    }\n]\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("联盟链的初始化可在qbase baseapp InitChain方法下执行，将解析的qcp信息保存到store中")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("func (app *BaseApp) InitChain(req abci.RequestInitChain) (res abci.ResponseInitChain) {\n    ...\n\t// 保存初始QCP配置\n\tinitQCP(app.deliverState.ctx, app.GetCdc(), req.AppStateBytes)\n\t...\n}\n\nfunc initQCP(ctx ctx.Context, cdc *go_amino.Codec, appState []byte) {\n\tif appState == nil {\n\t\treturn\n\t}\n\tgs := types.GenesisState{}\n\terr := cdc.UnmarshalJSON(appState, &gs)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tif len(gs.QCPs) > 0 {\n\t\tqcpMapper := GetQcpMapper(ctx)\n\t\tfor _, qcp := range gs.QCPs {\n\t\t\tqcpMapper.SetChainInTrustPubKey(qcp.ChainId, qcp.PubKey)\n\t\t}\n\t}\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("p",[s._v("无需在qos app initChainer()中添加qcps处理逻辑")])])}],!1,null,null,null);e.options.__file="genesis.md";n.default=e.exports}}]);